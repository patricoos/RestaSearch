@model RestaSearch.ViewModels.HomeViewModel
@using RestaSearch.Infrastructure
@{
	ViewBag.Title = "RestaSearch - Wyszukiwarka Restauracji";
}



<div class="bg-light ">
	<div class="container">
		<div class="row">
			<div class="col-md-6">
				<div class="card-header bg-primary text-white text-center">Kategorie</div>
				<div class=" border ">

					@foreach (var kategoria in Model.Kategorie)
					{
						<a class="btn btn-outline-primary m-1" href="@Url.Action("Lista", "Lokale", new { nazwaKategorii = kategoria.NazwaKategorii.ToLower() })"><i class="fa fa-fw fa-cutlery"></i>@kategoria.NazwaKategorii</a>
					}

					<div class=" m-1">
						<p>
							<button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#collapseExample" aria-expanded="false" aria-controls="collapseExample">Więcej kategorii</button>
						</p>
						<div class="collapse" id="collapseExample">
							<div class="card card-body">
								<h3>Rodzaj kuchni</h3>
								<p>
									<button class="btn btn-outline-primary m-1" data-toggle="buttons" type="checkbox" autocomplete="off">Włoska</button>
									<button class="btn btn-outline-primary m-1" data-toggle="buttons" type="checkbox" autocomplete="off">Ślaska</button>
									<button class="btn btn-outline-primary m-1" data-toggle="buttons" type="checkbox" autocomplete="off">Azjatycka</button>
									<button class="btn btn-outline-primary m-1" data-toggle="buttons" type="checkbox" autocomplete="off">Polska</button>
								</p>
								<h3>Inne</h3>
								<p>
									<button class="btn btn-outline-primary m-1" data-toggle="buttons" type="checkbox" autocomplete="off">Sala Weselna</button>
									<button class="btn btn-outline-primary m-1" data-toggle="buttons" type="checkbox" autocomplete="off">Imprezy Firmowe</button>
								</p>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="col-md-6">
				<div class="card-header bg-primary text-white text-center">Miejscowość</div>
				<div class=" my-0 border">

					<ul class="nav nav-pills mb-3" id="pills-tab" role="tablist">
						<li class="nav-item">
							<a class="nav-link active" id="pills-home-tab" data-toggle="pill" href="#pills-home" role="tab" aria-controls="pills-home" aria-selected="true">Wyzacz na mapie</a>
						</li>
						<li class="nav-item">
							<a class="nav-link" id="pills-profile-tab" data-toggle="pill" href="#pills-profile" role="tab" aria-controls="pills-profile" aria-selected="false">Pobierz lokalizacje</a>
						</li>
						<li class="nav-item">
							<a class="nav-link" id="pills-contact-tab" data-toggle="pill" href="#pills-contact" role="tab" aria-controls="pills-contact" aria-selected="false">Wybierz miejscowość</a>
						</li>
					</ul>
					<div class="tab-content" id="pills-tabContent">
						<div class="tab-pane fade show active" id="pills-home" role="tabpanel" aria-labelledby="pills-home-tab">
							<div id="map"></div>
							<button onclick="getLocation()">Pobierz swoją lokalizacje</button>

						</div>
						<div class="tab-pane fade" id="pills-profile" role="tabpanel" aria-labelledby="pills-profile-tab">
							<form class="form-inline  my-1">
								<input class="form-control mr-sm-0 w-75" type="search" placeholder="Wybierz miejscowość" aria-label="Search">
								<div class="form-group col-md-0">
									<select id="inputState" class="form-control">
										<option selected="">+ 0 km</option>
										<option>+ 5 km</option>
										<option>+ 10 km</option>
										<option>+ 15 km</option>
										<option>+ 30 km</option>
										<option>+ 50 km</option>
										<option>+ 75 km</option>
									</select>
								</div>
								@Html.DropDownListFor(m => m.Miejscowosci, new SelectList(Model.Miejscowosci, "MiejscowoscId", "Nazwa"))
							</form>
						</div>
						<div class="tab-pane fade" id="pills-contact" role="tabpanel" aria-labelledby="pills-contact-tab">

							<p>Pobierz swoją lokalizacje</p>
							<p id="demo"></p>
							<button onclick="getLocation()">Pobierz</button>

						</div>
					</div>
					</div>

			</div>
			<div class="col-md-12 text-center">
				<div class="row m-2">
					<div class="col-md-12 text-center">
						<a href="#" class="btn w-25 btn-secondary" target="">Szukaj</a>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>

<div class="p-1">
	<div class="container">
		<div class="row">
			<div class="col-md-12">
				<h1 class="">Promowane&nbsp;Lokale </h1>
			</div>
		</div>
		<div class="row">
			@foreach (var promowane in Model.Promowane)
			{
				<div class="col-md-3">
					<a href="@Url.Action("Szczegoly", "Lokale", new {id= promowane.LokalId })">
						<img class="img-fluid d-block" src="@Url.ObrazkiLokaliSciezka(promowane.NazwaPlikuObrazka)">
					</a>
					<p class="blockquote">@promowane.NazwaLokalu</p>
					<p class="font-weight-light">
						<b>@promowane.Miejscowosc.Nazwa</b> - @promowane.Ulica @promowane.NumerBudynku

						<br>Dzisiaj otwarte - 11:00–23:00
					</p>

				</div>
			}
		</div>
	</div>
</div>

<div class="p-1 bg-light">
	<div class="container">
		<div class="row">
			<div class="col-md-12">
				<h1 class="">Najczesciej odwiedzane</h1>
			</div>
		</div>
		<div class="row">
			@foreach (var najwys in Model.NajWyswietlen)
			{
				<div class="col-md-3">
					<a href="@Url.Action("Szczegoly", "Lokale", new { id= najwys.LokalId })">
						<img class="img-fluid d-block" src="@Url.ObrazkiLokaliSciezka(najwys.NazwaPlikuObrazka)">
					</a>
					<p class="blockquote">@najwys.NazwaLokalu</p>
					<p class="font-weight-light">
						<b>@najwys.Miejscowosc.Nazwa</b> - @najwys.Ulica @najwys.NumerBudynku
						<br>Dzisiaj otwarte - 11:00–23:00
					</p>
				</div>
			}
		</div>
	</div>
</div>

<div class="p-1">
	<div class="container">
		<div class="row">
			<div class="col-md-12">
				<h1 class="">Nowe Lokale</h1>
			</div>
		</div>
		<div class="row">
			@foreach (var nowosci in Model.Nowosci)
			{
				<div class="col-md-3">
					<a href="@Url.Action("Szczegoly", "Lokale", new {id= nowosci.LokalId })">
						<img class="img-fluid d-block" src="@Url.ObrazkiLokaliSciezka(nowosci.NazwaPlikuObrazka)">
					</a>
					<p class="blockquote">@nowosci.NazwaLokalu</p>
					<p class="font-weight-light">
						<b>@nowosci.Miejscowosc.Nazwa</b>  - @nowosci.Ulica @nowosci.NumerBudynku
						<br>Dzisiaj otwarte - 11:00–23:00
					</p>
				</div>
			}
		</div>
	</div>
</div>





<script>

	// In the following example, markers appear when the user clicks on the map.
	// The markers are stored in an array.
	// The user can then click an option to hide, show or delete the markers.
	var map;
	var markers = [];
	var punkt;

	function initMap() {
		map = new google.maps.Map(document.getElementById('map'), {
			center: { lat: 52.157758, lng: 19.1271972 },
			zoom: 6,
			gestureHandling: 'greedy'
		});

		// This event listener will call addMarker() when the map is clicked.
		map.addListener('click', function (event) {
			addMarker(event.latLng);
		});

		// Adds a marker at the center of the map.
	}

	// Adds a marker to the map and push to the array.
	function addMarker(location) {
		deleteMarkers();
		var marker = new google.maps.Marker({
			position: location,
			map: map
		});
		markers.push(marker);
	}

	// Sets the map on all markers in the array.
	function setMapOnAll(map) {
		for (var i = 0; i < markers.length; i++) {
			markers[i].setMap(map);
		}
	}

	// Removes the markers from the map, but keeps them in the array.
	function clearMarkers() {
		setMapOnAll(null);
	}

	// Shows any markers currently in the array.
	function showMarkers() {
		setMapOnAll(map);
	}

	// Deletes all markers in the array by removing references to them.
	function deleteMarkers() {
		clearMarkers();
		markers = [];
	}

	// Pobieranie i Wyświetlanie danych gps
	var x = document.getElementById("demo");

	function getLocation() {
		if (navigator.geolocation) {

			navigator.geolocation.getCurrentPosition(function (position) {
				myLatLng = new google.maps.LatLng({ lat: position.coords.latitude, lng: position.coords.longitude });
				addMarker(myLatLng);
			});
		} else {
			x.innerHTML = "Geolokacja nie jest obsługiwana przez Twoją wyszukiwarkę.";
		}
	}

	function showPosition(position) {
		x.innerHTML = "Latitude: " + position.coords.latitude +
			"<br>Longitude: " + position.coords.longitude;
	}
</script>
<script async defer
		src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDFR77SDuMS5dYX2vJmVVOq4lPAmSDI3t0&callback=initMap">
</script>

<style>
	#map {
		height: 400px;
		width: 100%;
	}

	#floating-panel {
		position: absolute;
		top: 60px;
		left: 30%;
		z-index: 5;
		background-color: #fff;
		padding: 5px;
		border: 1px solid #999;
		text-align: center;
		font-family: 'Roboto','sans-serif';
		line-height: 30px;
		padding-left: 10px;
	}
</style>